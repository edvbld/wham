%%
%% This is file `trfrac.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% trfrac.dtx  (with options: `file')
%% 
%% This is a generated file.
%% 
%% Copyright (C) 2005 by Kevin W. Hamlen
%% 
%% This file may be distributed and/or modified under the conditions of
%% the LaTeX Project Public License, either version 1.3a of this license
%% or (at your option) any later version.  The latest version of this
%% license is in:
%% 
%%    http://www.latex-project.org/lppl.txt
%% 
%% and version 1.3a or later is part of all distributions of LaTeX version
%% 2004/10/01 or later.
%% 
\newdimen\TRF@dimen
\newcommand\TRF@startp{31415926}
\newcommand\TRF@endp{27182818}
\newif\ifTRF@first
\newif\ifTRF@outer\TRF@outertrue
\newif\ifTRF@derivok\TRF@derivoktrue
\newdimen\TRF@lhang\TRF@lhang\z@
\newdimen\TRF@rhang\TRF@rhang\z@
\newdimen\TRF@xtrarhang
\newdimen\TRF@lsave
\newdimen\TRF@linewd
\newdimen\TRF@totalwd
\newdimen\TRF@denomwd
\newbox\TRF@numbox
\newbox\TRF@denombox
\newbox\TRF@eqbox
\newcommand\TRF@trfrac[3]{%
  \begingroup%
    \ifnum\lastpenalty=\TRF@startp\relax%
      \TRF@firsttrue%
    \else%
      \TRF@firstfalse%
    \fi%
    \TRF@lsave\TRF@lhang%
    \setbox\TRF@eqbox\hbox{\TRF@derivokfalse#1}%
    \ifdim\wd\TRF@eqbox>\z@%
      \setbox\TRF@eqbox\hbox{\kern\p@\unhbox\TRF@eqbox}%
    \fi%
    \TRF@lhang\z@%
    \setbox\TRF@numbox\hbox{%
      \TRF@outerfalse%
      \m@th$%
      \strut%
      \penalty\TRF@startp\relax%
      #2%
      \ifnum\lastpenalty=\TRF@endp\relax\else%
        \global\TRF@rhang\z@%
      \fi%
      $%
    }%
    \setbox\TRF@denombox\hbox{%
      \TRF@derivokfalse%
      \m@th$\strut#3$%
    }%
    \TRF@denomwd\wd\TRF@denombox%
    \ifdim\wd\TRF@numbox>\TRF@denomwd%
      \TRF@totalwd\wd\TRF@numbox%
    \else%
      \TRF@totalwd\TRF@denomwd%
    \fi%
    \TRF@linewd\wd\TRF@numbox%
    \advance\TRF@linewd-\TRF@lhang%
    \advance\TRF@linewd-\TRF@rhang%
    \ifdim\TRF@denomwd>\TRF@linewd%
      \advance\TRF@linewd-\TRF@denomwd%
      \advance\TRF@lhang.5\TRF@linewd%
      \global\advance\TRF@rhang.5\TRF@linewd%
      \ifdim\TRF@lhang<\z@\TRF@lhang\z@\fi%
      \ifdim\TRF@rhang<\z@\global\TRF@rhang\z@\fi%
      \TRF@linewd\TRF@denomwd%
    \fi%
    \ifdim\wd\TRF@eqbox>\TRF@rhang%
      \TRF@xtrarhang\wd\TRF@eqbox%
      \advance\TRF@xtrarhang-\TRF@rhang%
    \else%
      \TRF@xtrarhang\z@%
    \fi%
    \advance\TRF@totalwd\TRF@xtrarhang%
    \mathinner{%
      \ifTRF@outer%
        \raise\fontdimen22\textfont\tw@\vtop%
      \else%
        \vbox%
      \fi%
      {%
        \offinterlineskip%
        \hbox{%
          \vbox{%
            \TRF@dimen\fontdimen8\textfont\tw@%
            \advance\TRF@dimen-\fontdimen22\textfont\tw@%
            \advance\TRF@dimen-.5\fontdimen8\textfont\thr@@%
            \advance\TRF@dimen-\dp\TRF@numbox%
            \ifdim\TRF@dimen<3\fontdimen8\textfont\thr@@%
              \TRF@dimen3\fontdimen8\textfont\thr@@%
            \fi%
            \hb@xt@\TRF@totalwd{%
              \hfil%
              \unhbox\TRF@numbox%
              \hfil%
              \kern\TRF@xtrarhang%
            }%
            \kern\TRF@dimen%
            \hb@xt@\TRF@totalwd{%
              \kern\TRF@lhang%
              \vrule\@width\TRF@linewd%
                    \@height.5\fontdimen8\textfont\thr@@%
                    \@depth.5\fontdimen8\textfont\thr@@%
              \vbox to\z@{%
                \TRF@dimen.5\ht\TRF@eqbox%
                \advance\TRF@dimen.5\dp\TRF@eqbox%
                \kern-\TRF@dimen%
                \hb@xt@\z@{\box\TRF@eqbox\hss}%
                \kern-\TRF@dimen%
              }%
              \kern\TRF@rhang%
              \kern\TRF@xtrarhang%
            }%
          }%
        }%
        \TRF@dimen\fontdimen11\textfont\tw@%
        \advance\TRF@dimen\fontdimen22\textfont\tw@%
        \advance\TRF@dimen-.5\fontdimen8\textfont\thr@@%
        \advance\TRF@dimen-\ht\TRF@denombox%
        \ifdim\TRF@dimen<3\fontdimen8\textfont\thr@@%
          \TRF@dimen3\fontdimen8\textfont\thr@@%
        \fi%
        \kern\TRF@dimen%
        \hb@xt@\TRF@totalwd{%
          \kern\TRF@lhang%
          \hfil%
          \box\TRF@denombox%
          \hfil%
          \kern\TRF@rhang%
          \kern\TRF@xtrarhang%
        }%
      }%
    }%
    \ifTRF@outer\else%
      \penalty\TRF@endp\relax%
    \fi%
    \global\advance\TRF@rhang\TRF@xtrarhang%
    \ifdim\TRF@denomwd<\TRF@linewd%
      \advance\TRF@denomwd-\TRF@linewd%
      \advance\TRF@lhang-.5\TRF@denomwd%
      \global\advance\TRF@rhang-.5\TRF@denomwd%
    \fi%
    \global\TRF@lhang\ifTRF@first\TRF@lhang\else\TRF@lsave\fi%
  \endgroup%
}
\newcommand\trfrac[3][]{%
  \ifTRF@derivok%
    \ifmmode%
      \TRF@trfrac{#1}{#2}{#3}%
    \else%
      \TRF@mmerr%
    \fi%
  \else%
    \TRF@derr%
  \fi%
}
\newcommand\TRF@mmerr{%
  \PackageError{trfrac}{\protect\trfrac\space%
     only allowed in math mode}%
    {I encountered a \protect\trfrac\space%
     macro without first encountering a begin-math token.}%
}
\newcommand\TRF@derr{%
  \PackageError{trfrac}{\protect\trfrac\space%
     not allowed in the consequent of another \protect\trfrac}%
    {\protect\trfrac\space can only appear in the premise (numerator%
     ) of another \protect\trfrac, not in the consequent (denominator%
     ) of a \protect\trfrac.}%
}
\newcommand\TRF@next{}
\newcommand\TRF@sep{\futurelet\TRF@next\TRF@@sep}
\newcommand\TRF@@sep{%
  \ifx[\TRF@next%
    \let\TRF@next\TRF@separg%
  \else%
    \let\TRF@next\TRF@sepnoarg%
  \fi%
  \TRF@next%
}
\newcommand\TRF@separg{}
\def\TRF@separg[#1]{\cr\noalign{\kern#1}}
\newcommand\TRF@sepnoarg{\cr}
\newenvironment{trgather}{%
  \vbox\bgroup%
    \let\\\TRF@sep%
    \ialign\bgroup\hfil{\m@th$##$}\hfil\cr%
}{%
  \crcr\egroup\egroup%
}
\newenvironment{tralign}{%
  \vbox\bgroup%
    \let\\\TRF@sep%
    \ialign\bgroup\hfil{\m@th$##\null$}&{\m@th$\null##$}\hfil\cr%
}{%
  \crcr\egroup\egroup%
}
\endinput
%%
%% End of file `trfrac.sty'.
